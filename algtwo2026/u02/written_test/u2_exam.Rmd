---
header-includes:
   - \usepackage{array}
output: pdf_document
params:
    rseed: 0
    showsol: true
    titex: "practice"
urlcolor: blue
geometry: margin=1in
---

```{r,echo=F}
if(params$rseed != 0){
    set.seed(params$rseed)
}
```

\sc Name: \hspace{4in}  Date: \vspace{5pt} \hrule \rm

# Unit-2 Mastery Assessment (version `r params$rseed`)

```{r q1, echo = FALSE, results = "hide"}
am = "B\\cdot\\left(X+A\\right)"
ad = "\\frac{X+A}{B}"
sm = "B\\cdot\\left(X-A\\right)"
sd = "\\frac{X-A}{B}"
ma = "A\\cdot X+B"
da = "\\frac{X}{A}+B"
ms = "A\\cdot X-B"
ds = "\\frac{X}{A}-B"
qs = c(am,ad,sm,sd,ma,da,ms,ds) #For outer expression

am2 = "B\\left(X+A\\right)"
ad2 = "\\frac{X+A}{B}"
sm2 = "B\\left(X-A\\right)"
sd2 = "\\frac{X-A}{B}"
ma2 = "A X+B"
da2 = "\\frac{X}{A}+B"
ms2 = "A X-B"
ds2 = "\\frac{X}{A}-B"
qs2 = c(am2,ad2,sm2,sd2,ma2,da2,ms2,ds2) #For argument expression


ops = list(c("Add","Multiply by"),
           c("Add","Divide by"),
           c("Subtract","Multiply by"),
           c("Subtract","Divide by"),
           c("Multiply by","Add"),
           c("Divide by","Add"),
           c("Multiply by","Subtract"),
           c("Divide by","Subtract"))

fam = function(X,A,B){B*(X+A)}
fad = function(X,A,B){(X+A)/B}
fsm = function(X,A,B){B*(X-A)}
fsd = function(X,A,B){(X-A)/B}
fma = function(X,A,B){A*X+B}
fda = function(X,A,B){X/A+B}
fms = function(X,A,B){A*X-B}
fds = function(X,A,B){X/A-B}
fs = list(fam,fad,fsm,fsd,fma,fda,fms,fds)

t1 = sample(1:8,1) #arg exp
t2 = sample(1:8,1) #out exp
while(T){
    ns = sample(2:50,4)
    x1 = sample(2:50,1)
    y1 = fs[[t1]](x1,ns[3],ns[4])
    x2 = sample(2:50,1)
    y2 = fs[[t2]](x2,ns[1],ns[2])
    if(y1%%1==0 && y2%%1==0 && y1>1 && y2>1 && y1<51 && y2<51 && length(unique(c(ns,x1,y1,x2,y2)))==8){break}
}
outexp = gsub("A",ns[1],qs[t2],fixed=T)
outexp = gsub("B",ns[2],outexp,fixed=T)
exp1 = gsub("X","f{\\left[arg\\right]}",outexp,fixed=T)
exp1 = gsub("arg",qs2[t1],exp1,fixed=T)
exp1 = gsub("X","x",exp1,fixed=T)
exp1 = gsub("A",ns[3],exp1,fixed=T)
exp1 = gsub("B",ns[4],exp1,fixed=T)

if(params$showsol){
    solx = paste0("\\color{red}",x1,"\\color{black}")
    soly = paste0("\\color{red}",y2,"\\color{black}")
} else {
    solx = ""
    soly = ""
}

```

### Question 1 (10 points)

Let $f$ represent a function. If $f[`r y1`]=`r x2`$, then there exists a knowable solution to the equation below.

$$y=`r exp1`$$

Find the solution.

\vspace{0.2in}

$x=$ `r solx` 

\vspace{0.4in}

$y=$ `r soly`

\vspace{0.2in}


```{r,echo=F}
# use sqrt, cbrt, cube, exp2, log2 for stretch/shift
# use sqrt, exp2, log2 for reflections

# shift left, right, up, down by distance 2
# stretch vbig, vshrink, hbig, hshrink by factor 2
# refl h, refl v
# 10 total transformations...

# 4 on page 1 and 6 on page 2?

flv = c("\\sqrt{x}","\\sqrt[3]{x}","x^3","2^{x}","\\log_{2}\\left(x\\right)","x^2")
flh = c("\\sqrt{x}","\\sqrt[3]{x}","\\left(x\\right)^3","2^{x}","\\log_{2}\\left(x\\right)","\\left(x\\right)^2")

fs = list(function(x){sqrt(x)},
          function(x){sign(x)*abs(x)^(1/3)},
          function(x){x^3},
          function(x){2^x},
          function(x){log2(x)},
          function(x){x^2})

xas = list(NA,NA,NA,c(-10,10),c(0,0),NA)
yas = list(NA,NA,NA,c(0,0),c(-10,10),NA)

xls = list(seq(0,12,0.01),
           seq(-12,12,0.01), 
           seq(-3,3,0.01),
           seq(-12,4,0.01),
           seq(0.0001,10.0001,0.01),
           seq(-4,4,0.01))
xps = list(c(0,1,4,9),
           c(-8,-1,0,1,8),
           c(-3,-2,-1,0,1,2,3),
           c(0,1,2,3),
           c(1,2,4,8),
           c(-3,-2,-1,0,1,2,3))
yls = list()
yps = list()
for(i in 1:6){
    yls[[i]] = fs[[i]](xls[[i]])
    yps[[i]] = fs[[i]](xps[[i]])
}

ord1 = c(sample(c(1,4,5),2),sample(c(1:6,2,3,6),8))

xl = list()
yl = list()
xp = list()
yp = list()
xa = list()
ya = list()

# vr, hr, l, r, u, d, hst, hsh, vst, vsh
tex1 = paste0("y=-",flv[ord1[1]])
xl[[1]] = xls[[ord1[1]]]
yl[[1]] = -yls[[ord1[1]]]
xp[[1]] = xps[[ord1[1]]]
yp[[1]] = -yps[[ord1[1]]]
xa[[1]] = xas[[ord1[1]]]
ya[[1]] = -yas[[ord1[1]]]

tex2 = paste0("y=",gsub("x","-x",flh[ord1[2]],fixed=T))
xl[[2]] = -xls[[ord1[2]]]
yl[[2]] = yls[[ord1[2]]]
xp[[2]] = -xps[[ord1[2]]]
yp[[2]] = yps[[ord1[2]]]
xa[[2]] = -xas[[ord1[2]]]
ya[[2]] = yas[[ord1[2]]]

tex3 = paste0("y=",gsub("x","x+2",flh[ord1[3]],fixed=T))
xl[[3]] = xls[[ord1[3]]]-2
yl[[3]] = yls[[ord1[3]]]
xp[[3]] = xps[[ord1[3]]]-2
yp[[3]] = yps[[ord1[3]]]
xa[[3]] = xas[[ord1[3]]]-2
ya[[3]] = yas[[ord1[3]]]

tex4 = paste0("y=",gsub("x","x-2",flh[ord1[4]],fixed=T))
xl[[4]] = xls[[ord1[4]]]+2
yl[[4]] = yls[[ord1[4]]]
xp[[4]] = xps[[ord1[4]]]+2
yp[[4]] = yps[[ord1[4]]]
xa[[4]] = xas[[ord1[4]]]+2
ya[[4]] = yas[[ord1[4]]]

tex5 = paste0("y=",flv[ord1[5]],"+2")
xl[[5]] = xls[[ord1[5]]]
yl[[5]] = yls[[ord1[5]]]+2
xp[[5]] = xps[[ord1[5]]]
yp[[5]] = yps[[ord1[5]]]+2
xa[[5]] = xas[[ord1[5]]]
ya[[5]] = yas[[ord1[5]]]+2

tex6 = paste0("y=",flv[ord1[6]],"-2")
xl[[6]] = xls[[ord1[6]]]
yl[[6]] = yls[[ord1[6]]]-2
xp[[6]] = xps[[ord1[6]]]
yp[[6]] = yps[[ord1[6]]]-2
xa[[6]] = xas[[ord1[6]]]
ya[[6]] = yas[[ord1[6]]]-2

tex7 = paste0("y=",gsub("x","\\frac{x}{2}",flh[ord1[7]],fixed=T))
xl[[7]] = xls[[ord1[7]]]*2
yl[[7]] = yls[[ord1[7]]]
xp[[7]] = xps[[ord1[7]]]*2
yp[[7]] = yps[[ord1[7]]]
xa[[7]] = xas[[ord1[7]]]*2
ya[[7]] = yas[[ord1[7]]]

tex8 = paste0("y=",gsub("x","2x",flh[ord1[8]],fixed=T))
xl[[8]] = xls[[ord1[8]]]/2
yl[[8]] = yls[[ord1[8]]]
xp[[8]] = xps[[ord1[8]]]/2
yp[[8]] = yps[[ord1[8]]]
xa[[8]] = xas[[ord1[8]]]/2
ya[[8]] = yas[[ord1[8]]]

tex9 = paste0("y=2\\cdot ",flv[ord1[9]])
xl[[9]] = xls[[ord1[9]]]
yl[[9]] = yls[[ord1[9]]]*2
xp[[9]] = xps[[ord1[9]]]
yp[[9]] = yps[[ord1[9]]]*2
xa[[9]] = xas[[ord1[9]]]
ya[[9]] = yas[[ord1[9]]]*2

tex10 = paste0("y=\\frac{",flv[ord1[10]],"}{2}")
xl[[10]] = xls[[ord1[10]]]
yl[[10]] = yls[[ord1[10]]]/2
xp[[10]] = xps[[ord1[10]]]
yp[[10]] = yps[[ord1[10]]]/2
xa[[10]] = xas[[ord1[10]]]
ya[[10]] = yas[[ord1[10]]]/2

texes = c(tex1,tex2,tex3,tex4,tex5,tex6,tex7,tex8,tex9,tex10)

ord2 = sample(1:10)

```

### Question 2 (20 points)

Graph the equations accurately. For each integer-integer point on the parent, indicate the corresponding point precisely. Also, with dashed lines, indicate any asymptotes.

```{r,echo=F,fig.dim=c(7,5)}
library(latex2exp)
par(mar=c(0,0,0,0),pty="s")

layout(matrix(c(1,2,4,3,5,6,8,7),2,byrow = T),c(1,2,2,1))

mkgrid = function(){
    plot(0,0,"n",xlim=c(-5,5),ylim=c(-5,5),axes=F,ann=F)
    for(jj in -5:5){
        lines(c(-5,5),c(jj,jj),col="grey",lwd=0.5)
        lines(c(jj,jj),c(-5,5),col="grey",lwd=0.5)
    }
    lines(c(-5,5),c(-5,-5),col="darkgrey",lwd=0.8)
    lines(c(-5,5),c(5,5),col="darkgrey",lwd=0.8)
    lines(c(-5,-5),c(-5,5),col="darkgrey",lwd=0.8)
    lines(c(5,5),c(-5,5),col="darkgrey",lwd=0.8)
    arrows(-5.2,0,5.2,0,0.03,15,3)
    arrows(0,-5.2,0,5.2,0.03,15,3)
    text(5,0,5,adj=c(0.5,1.5),cex=0.6)
    text(5,0,"x",adj=c(-0.3,-0.4),cex=0.6)
    text(0,5,5,adj=c(1.5,0.5),cex=0.6)
    text(0,5,"y",adj=c(-0.4,-0.3),cex=0.6)
}

for(i in 1:4){
    plot(0,0,"n",xlim=c(-1,1),ylim=c(-1,1),axes=F,ann=F)
    text(0,0,TeX(paste0("$",texes[ord2[i]],"$")),cex=1.5)
    
    mkgrid()
    if(params$showsol){
        if(!(is.na(xa[[ord2[i]]][1]))){
            lines(xa[[ord2[i]]],ya[[ord2[i]]],lty=2,col="red",lwd=1.3)
        }
        lines(xl[[ord2[i]]],yl[[ord2[i]]],col="red",lwd=1.3)
        points(xp[[ord2[i]]],yp[[ord2[i]]],pch=19,cex=0.7,col="red")
    }
}
```

\newpage

### Question 2 continued...

```{r,echo=F,fig.dim=c(7,7.5)}
library(latex2exp)
par(mar=c(0,0,0,0),pty="s")

layout(matrix(c(1,2,4,3,5,6,8,7,9,10,12,11),3,byrow = T),c(1,2,2,1))

for(i in 5:10){
    plot(0,0,"n",xlim=c(-1,1),ylim=c(-1,1),axes=F,ann=F)
    text(0,0,TeX(paste0("$",texes[ord2[i]],"$")),cex=1.5)
    
    mkgrid()
    
    if(params$showsol){
        if(!(is.na(xa[[ord2[i]]][1]))){
            lines(xa[[ord2[i]]],ya[[ord2[i]]],lty=2,col="red",lwd=1.3)
        }
        lines(xl[[ord2[i]]],yl[[ord2[i]]],col="red",lwd=1.3)
        points(xp[[ord2[i]]],yp[[ord2[i]]],pch=19,cex=0.7,col="red")
    }
}
```

\newpage


### Question 3 (20 points)


```{r,echo=F}
while(T){
    xp = sort(sample(-10:10,5))
    while(T){
        yp = sample(1:10,5,T)*c(1,-1,1,-1,-1)*sample(c(-1,1),1)
        if(abs(yp[5])<abs(yp[4])){break}
    }
    
    if(sample(1:2,1)==1){
        yp = rev(yp)
    }
    xa = min(xp):max(xp)
    ya = rep(0,length(xa))
    for(i in 1:length(xa)){
        x = xa[i]
        xl = max(xp[xp<=x])
        xr = min(c(xp[xp>x],xp[length(xp)]))
        yl = yp[xp==xl]
        yr = yp[xp==xr]
        rat = (x-xl)/(xr-xl)
        if(x>xl){
            ya[i] = yl*(1-rat)+yr*rat
        } else {
            ya[i] = yl
        }
        
    }
    if(sum(ya==0)==3 && !(min(ya)==min(xa) && max(ya)==max(xa))){break}
}

xpn = c(xa[1],xa[ya==0],xa[length(xa)])
ipos = character()
ineg = character()
for(i in 1:(length(xpn)-1)){
    xl = xpn[i]
    xr = xpn[i+1]
    xt = xl+1
    yl = ya[xa==xl]
    yt = ya[xa==xt]
    ymid = mean(c(yl,yt))
    if(ymid>0){
        ipos = c(ipos,paste0("(",xl,", ",xr,")",collapse=""))
    } else {
        ineg = c(ineg,paste0("(",xl,", ",xr,")",collapse=""))
    }
}
iinc = character()
idec = character()
for(i in 1:(length(xp)-1)){
    xl = xp[i]
    xr = xp[i+1]
    xt = xl+1
    yl = ya[xa==xl]
    yt = ya[xa==xt]
    if(yt>yl){
        iinc = c(iinc,paste0("(",xl,", ",xr,")",collapse=""))
    } else {
        idec = c(idec,paste0("(",xl,", ",xr,")",collapse=""))
    }
}


if(params$showsol){
    posint = paste0("$",paste0(ipos,collapse=" \\cup "),"$",collapse="")
    negint = paste0("$",paste0(ineg,collapse=" \\cup "),"$",collapse="")
    incint = paste0("$",paste0(iinc,collapse=" \\cup "),"$",collapse="")
    decint = paste0("$",paste0(idec,collapse=" \\cup "),"$",collapse="")
    domint = paste0("$(",min(xp),", ",max(xp),")$")
    ranint = paste0("$(",min(yp),", ",max(yp),")$")
} else {
    posint = ""
    negint = ""
    incint = ""
    decint = ""
    domint = ""
    ranint = ""
}


```

A function is graphed below.

```{r,echo=F,fig.dim=c(5,4)}
layout(matrix(c(1,1,1,1,2),nrow=1))
par(mar=c(0,0,0,0),pty="s")
plot(xa,ya,"l",xlim=c(-10,10),ylim=c(-10,10),axes=F,ann=F)
for(i in -10:10){
    lines(c(-10,10),c(i,i),col="lightgrey",lwd=0.5)
    lines(c(i,i),c(-10,10),col="lightgrey",lwd=0.5)
}
for(i in seq(-10,10,5)){
    lines(c(-10,10),c(i,i),col="darkgrey",lwd=1)
    lines(c(i,i),c(-10,10),col="darkgrey",lwd=1)
}
arrows(-10.3,0,10.3,0,0.1,10,3,lwd=2)
arrows(0,-10.3,0,10.3,0.1,10,3,lwd=2)
lines(xa,ya,col="blue",lwd=3)
points(xp,yp,pch=20,col="blue",cex=1.6)
points(xa[1],ya[1],pch=20,col="white",cex=0.8)
points(xa[length(xa)],ya[length(xa)],pch=20,col="white",cex=0.8)

text(10,-0.5,"10",cex=0.8)
text(-10,-0.5,"-10",cex=0.8)
text(-0.5,10,"10",cex=0.8)
text(-0.5,-10,"-10",cex=0.8)
text(10,0.5,"x",cex=0.8)
text(0.5,10,"y",cex=0.8)

plot(0,0,"n",axes=F,ann=F)
legend("center",legend="y = f(x)",col="blue",lwd=3)



```
\

Indicate the following intervals using interval notation.

\begin{tabular}{|m{1in}|m{5in}|}\hline
Feature & Where \\ \hline \hline
Positive & \color{red}`r posint`\color{black} \\  [2.5em]  \hline
Negative & \color{red}`r negint`\color{black} \\  [2.5em]  \hline
Increasing & \color{red}`r incint`\color{black} \\ [2.5em]  \hline
Decreasing & \color{red}`r decint`\color{black} \\ [2.5em]  \hline
Domain & \color{red}`r domint`\color{black} \\ [2.5em]  \hline
Range & \color{red}`r ranint`\color{black} \\ [2.5em]  \hline
\end{tabular}


\newpage


### Question 4 (20 points)

```{r q4_data, echo = FALSE, results = "hide"}
xmin = -100
ymin = -100
xmax = 100
ymax = 100
np = 4

exp_frames = c("M\\left(x+A\\right)",
               "M x+A",
               "M\\left(x-A\\right)",
               "M x-A",
               "\\frac{x+A}{M}",
               "\\frac{x}{M}+A",
               "\\frac{x-A}{M}",
               "\\frac{x}{M}-A")

hwd = c("1. Horizontal shrink by factor M.\n2. Translate left by distance A.",
        "1. Translate left by distance A.\n2. Horizontal shrink by factor M.",
        "1. Horizontal shrink by factor M.\n2.  Translate right by distance A.",
        "1. Translate right by distance A.\n2. Horizontal shrink by factor M.",
        "1. Horizontal stretch by factor M.\n2. Translate left by distance A.",
        "1. Translate left by distance A.\n2. Horizontal stretch by factor M.",
        "1. Horizontal stretch by factor M.\n2. Translate right by distance A.",
        "1. Translate right by distance A.\n2. Horizontal stretch by factor M.")

exp_frames2 = c("M\\cdot\\left(x+A\\right)",
               "M\\cdot x+A",
               "M\\cdot\\left(x-A\\right)",
               "M\\cdot x-A",
               "\\frac{x+A}{M}",
               "\\frac{x}{M}+A",
               "\\frac{x-A}{M}",
               "\\frac{x}{M}-A")

vwd = c("1. Translate up by distance A.\n2. Vertical stretch by factor M.",
        "1. Vertical stretch by factor M.\n2. Translate up by distance A.",
        "1. Translate down by distance A.\n2. Vertical stretch by factor M.",
        "1. Vertical stretch by factor M.\n2. Translate down by distance A.",
        "1. Translate up by distance A.\n2. Vertical shrink by factor M.",
        "1. Vertical shrink by factor M.\n2. Translate up by distance A.",
        "1. Translate down by distance A.\n2. Vertical shrink by factor M.",
        "1. Vertical shrink by factor M. \n2. Translate down by distance A.")

funcs = list(function(x,A,M){M*(x+A)},
             function(x,A,M){M*x+A},
             function(x,A,M){M*(x-A)},
             function(x,A,M){M*x-A},
             function(x,A,M){(x+A)/M},
             function(x,A,M){x/M+A},
             function(x,A,M){(x-A)/M},
             function(x,A,M){x/M-A}
             )

while(T){
    exp_types = sample(1:8,2,T)
    et1 = exp_types[1]
    et2 = exp_types[2]
    mas = sample(2:6,4)
    m1 = mas[1]
    m2 = mas[2]
    a1 = mas[3]
    a2 = mas[4]
    xold = numeric()
    yold = numeric()
    xnew = numeric()
    ynew = numeric()
    while(length(xold)<np){
        xo = sample(-100:100,1)
        yo = sample(-100:100,1)
        xn = funcs[[9-et1]](xo,a1,m1)
        yn = funcs[[et2]](yo,a2,m2)
        if(xn%%1==0 && yn%%1==0 && !(xo %in% xold) && !(yo %in% yold) && 
           xn>=xmin && xn<=xmax && yn>=ymin && yn<=ymax){
            xold = c(xold,xo)
            yold = c(yold,yo)
            xnew = c(xnew,xn)
            ynew = c(ynew,yn)
            }
    }
    xoldsorted = sort(xold)
    yoldunsorted = yold
    xnewunsorted = xnew
    ynewunsorted = ynew
    for(i in 1:length(xoldsorted)){
        j = which(xold==xoldsorted[i])
        yold[i] = yoldunsorted[j]
        xnew[i] = xnewunsorted[j]
        ynew[i] = ynewunsorted[j]
    }
    xold = xoldsorted
    if(min(xold)<0 && max(xold)>0 &&
       min(yold)<0 && max(yold)>0 &&
       min(xnew)<0 && max(xnew)>0 &&
       min(ynew)<0 && max(ynew)>0 &&
       max(xold)-min(xold)>10 &&
       max(yold)-min(yold)>10 &&
       max(xnew)-min(xnew)>10 &&
       max(ynew)-min(ynew)>10){break}
}

exp1 = exp_frames2[et2]
exp1 = gsub("A",a2,exp1,fixed=T)
exp1 = gsub("M",m2,exp1,fixed=T)
exp1 = gsub("x","f{\\left[arg\\right]}",exp1,fixed=T)
exp1 = gsub("arg",exp_frames[et1],exp1,fixed=T)
exp1 = gsub("A",a1,exp1,fixed=T)
exp1 = gsub("M",m1,exp1,fixed=T)

exb1 = exp_frames2[et2]
exb1 = gsub("A",a2,exb1,fixed=T)
exb1 = gsub("M",m2,exb1,fixed=T)
exb1 = gsub("x","f{\\left[a\\right]}",exb1,fixed=T)

argex = exp_frames[et1]
argex = gsub("A",a1,argex,fixed=T)
argex = gsub("M",m1,argex,fixed=T)

invarg = exp_frames[9-et1]
invarg = gsub("A",a1,invarg,fixed=T)
invarg = gsub("M",m1,invarg,fixed=T)
invarg = gsub("x","a",invarg,fixed=T)

invsub = exp_frames2[9-et1]
invsub = gsub("A",a1,invsub,fixed=T)
invsub = gsub("M",m1,invsub,fixed=T)
invsub = gsub("x",xold[1],invsub,fixed=T)

# argwd = wd[et1]
# argwd = gsub("A",a1,argwd,fixed=T)
# argwd = gsub("M",m1,argwd,fixed=T)

hwd1 = hwd[et1]
hwd1 = gsub("A",a1,hwd1,fixed=T)
hwd1 = gsub("M",m1,hwd1,fixed=T)

vwd1 = vwd[et2]
vwd1 = gsub("A",a2,vwd1,fixed=T)
vwd1 = gsub("M",m2,vwd1,fixed=T)

outex = exp_frames[et2]
outex = gsub("A",a2,outex,fixed=T)
outex = gsub("M",m2,outex,fixed=T)
outex = gsub("x","b",outex,fixed=T)

```


Let $f$ represent a function. The curves $b=f[a]$ and $y=`r exp1`$ are represented below in a table and on graphs.

```{r,echo=F,warning=F}
library(kableExtra)
df = data.frame(xold,yold,xnew,ynew)
colnames(df) = c("a","b","x","y")
kable(df) %>%
    kable_styling("bordered",full_width = F)
```

```{r,echo=F,fig.dim=c(6.5,6.5/4)}
par(mar=c(0,0,0,0),oma=c(0,0,0,0),pty="s",mfrow=c(1,4))

plotgrid = function(labs = c("x","y")){
    plot(0,0,"n",xlim=c(-100,100),ylim=c(-100,100),axes=F,ann=F)
    arrows(-100,0,100,0,0.04,15,3)
    arrows(0,-100,0,100,0.04,15,3)
    text(100,0,labs[1],adj=c(0.5,1.5))
    text(0,100,labs[2],adj=c(1.5,0.5))
}

plot(0,0,"n",axes=F,ann=F,xlim=c(-1,1),ylim=c(-1,1))
text(0,0,TeX("$b=f[a]$"))

plotgrid(c("a","b"))
lines(xold,yold,col="blue",lwd=2)
points(xold,yold,col="blue",pch=19,cex=0.7)

plotgrid(c("x","y"))
lines(xnew,ynew,col="blue",lwd=2)
points(xnew,ynew,col="blue",pch=19,cex=0.7)

plot(0,0,"n",axes=F,ann=F,xlim=c(-1,1),ylim=c(-1,1))
text(0,0,TeX(paste0("$y=",exp1,"$")))

```

a. Write formulas for calculating $x$ from $a$ and calculating $y$ from $b$. (Or, write the coordinate transformation formula.)

\vfill

```{r,echo=F,results='asis',eval=params$showsol}
cat("\\color{red}\n\n")
cat(paste0("$$x=",invarg,"$$"))
cat("\n\n")
cat(paste0("$$y=",outex,"$$"))
cat("\n\nOr, you can write the formulas as a coordinate transformation:")

cat(paste0("$$(a,b) \\to \\left(",invarg,"~,~",outex,"\\right)$$"))

cat("\\color{black}\n\n")
```

\vfill

b. What geometric transformations (using words like translation, stretch, and shrink), and in what order, would transform the first curve $y=f[x]$ into the second curve $y=`r exp1`$?

\vfill

```{r,echo=F,results='asis',eval=params$showsol}
cat("\\color{red}\n\n")
cat(hwd1)
cat("\n\n")
cat(vwd1)
cat("\n\nOr, technically, the vertical transformations could come first.\n\n")
cat(vwd1)
cat("\n\n")
cat(hwd1)
cat("\n\\color{black}\n\n")
```


\vfill

\newpage

\color{black}

### Question 5 (10 points)

```{r,echo=F}
# Describe transformations and give plot... they then give equation!
exp_frames = c("M\\left(x+A\\right)",
               "M x+A",
               "M\\left(x-A\\right)",
               "M x-A",
               "-\\left(x+A\\right)",
               "-x+A",
               "-\\left(x-A\\right)",
               "-x-A",
               "\\frac{x+A}{M}",
               "\\frac{x}{M}+A",
               "\\frac{x-A}{M}",
               "\\frac{x}{M}-A")

hwd = c("1. Horizontal shrink by factor M.\n2. Translate left by distance A.",
        "1. Translate left by distance A.\n2. Horizontal shrink by factor M.",
        "1. Horizontal shrink by factor M.\n2.  Translate right by distance A.",
        "1. Translate right by distance A.\n2. Horizontal shrink by factor M.",
        "1. Horizontal reflection over $y$ axis.\n2. Translate left by distance A.",
        "1. Translate left by distance A.\n2. Horizontal reflection over $y$ axis.",
        "1. Horizontal reflection over $y$ axis.\n2.  Translate right by distance A.",
        "1. Translate right by distance A.\n2. Horizontal reflection over $y$ axis.",
        "1. Horizontal stretch by factor M.\n2. Translate left by distance A.",
        "1. Translate left by distance A.\n2. Horizontal stretch by factor M.",
        "1. Horizontal stretch by factor M.\n2. Translate right by distance A.",
        "1. Translate right by distance A.\n2. Horizontal stretch by factor M.")

exp_frames2 = c("M\\cdot\\left(x+A\\right)",
               "M\\cdot x+A",
               "M\\cdot\\left(x-A\\right)",
               "M\\cdot x-A",
               "-\\left(x+A\\right)",
               "-x+A",
               "-\\left(x-A\\right)",
               "-x-A",
               "\\frac{x+A}{M}",
               "\\frac{x}{M}+A",
               "\\frac{x-A}{M}",
               "\\frac{x}{M}-A")

vwd = c("1. Translate up by distance A.\n2. Vertical stretch by factor M.",
        "1. Vertical stretch by factor M.\n2. Translate up by distance A.",
        "1. Translate down by distance A.\n2. Vertical stretch by factor M.",
        "1. Vertical stretch by factor M.\n2. Translate down by distance A.",
        "1. Translate up by distance A.\n2. Vertical reflection over $x$ axis.",
        "1. Vertical reflection over $x$ axis.\n2. Translate up by distance A.",
        "1. Translate down by distance A.\n2. Vertical reflection over $x$ axis.",
        "1. Vertical reflection over $x$ axis.\n2. Translate down by distance A.",
        "1. Translate up by distance A.\n2. Vertical shrink by factor M.",
        "1. Vertical shrink by factor M.\n2. Translate up by distance A.",
        "1. Translate down by distance A.\n2. Vertical shrink by factor M.",
        "1. Vertical shrink by factor M. \n2. Translate down by distance A.")

funcs = list(function(x,A,M){M*(x+A)},
             function(x,A,M){M*x+A},
             function(x,A,M){M*(x-A)},
             function(x,A,M){M*x-A},
             function(x,A,M){-1*(x+A)},
             function(x,A,M){-1*x+A},
             function(x,A,M){-1*(x-A)},
             function(x,A,M){-1*x-A},
             function(x,A,M){(x+A)/M},
             function(x,A,M){x/M+A},
             function(x,A,M){(x-A)/M},
             function(x,A,M){x/M-A}
             )

pick1 = sample(5:8,1)
pick2 = sample(c(1:4,9:12),1)
picks = sample(c(pick1,pick2))

aa = sample(c(1,3),2)

hdesc = hwd[picks[1]]
hdesc = gsub("M","2",hdesc,fixed=T)
hdesc = gsub("A",aa[1],hdesc,fixed=T)
ha = aa[1]
hm = 2
if(picks[1] %in% c(5:8)){
    hm = -1
}

vdesc = vwd[picks[2]]
vdesc = gsub("M","2",vdesc,fixed=T)
vdesc = gsub("A",aa[2],vdesc,fixed=T)
va = aa[2]
vm = 2
if(picks[2] %in% c(5:8)){
    vm = -1
}

eq = exp_frames2[picks[2]]
eq = gsub("M",vm,eq,fixed=T)
eq = gsub("A",va,eq,fixed=T)
eq = gsub("x","\\sqrt{x}",eq,fixed=T)
eq = gsub("x",exp_frames[picks[1]],eq,fixed=T)
eq = gsub("M",hm,eq,fixed=T)
eq = gsub("A",ha,eq,fixed=T)


```


A parent square-root function is transformed in the following ways:

#### Horizontal transformations

`r hdesc`

#### Vertical transformations

`r vdesc`

#### Resulting graph (and parent function in dashed grey): \


```{r,echo=F,fig.dim=c(4,4)}
par(mar=c(0,0,0,0),oma=c(0,0,0,0),pty="s")
plot(0,0,"n",xlim=c(-10,10),ylim=c(-10,10),axes=F,ann=F)
for(i in -10:10){
    lines(c(-10,10),c(i,i),col="lightgrey",lwd=0.5)
    lines(c(i,i),c(-10,10),col="lightgrey",lwd=0.5)
}
for(i in seq(-10,10,5)){
    lines(c(-10,10),c(i,i),col="darkgrey",lwd=1)
    lines(c(i,i),c(-10,10),col="darkgrey",lwd=1)
}
arrows(-10.3,0,10.3,0,0.1,10,3,lwd=2)
arrows(0,-10.3,0,10.3,0.1,10,3,lwd=2)
text(10,0,10,adj=c(0.5,1.5),cex=0.7)
text(0,10,10,adj=c(1.5,0.5),cex=0.7)

text(10,0,"x",adj=c(-1.1,-1.1),cex=0.7)
text(0,10,"y",adj=c(-1.1,-1.1),cex=0.7)


xx = seq(0,10,0.01)
yy = sqrt(xx)
lines(xx,yy,col="grey",lty=2)
xx = c(0,1,4,9)
yy = sqrt(xx)
points(xx,yy,col="grey",cex=0.6)


xl = seq(0,40,0.01)
yl = sqrt(xl)
xl2 = funcs[[13-picks[[1]]]](xl,ha,hm)
yl2 = funcs[[picks[[2]]]](yl,va,vm)
xl = xl2[abs(yl2)<=10]
yl = yl2[abs(yl2)<=10]
xl2 = xl[abs(xl)<=10]
yl2 = yl[abs(xl)<=10]

lines(xl2,yl2,col="blue",lwd=2)

xp = c(0,1,4,9,16,25,36,49)
yp = sqrt(xp)
xp2 = funcs[[13-picks[[1]]]](xp,ha,hm)
yp2 = funcs[[picks[[2]]]](yp,va,vm)

points(xp2,yp2,col="blue",pch=19,cex=0.7)

```

* What is the equation for the curve shown above?

```{r,echo=F,results='asis'}
if(params$showsol){
    cat("\\color{red}\n\n")
    cat(paste0("$$y=",eq,"$$"))
    cat("\n\n\\color{black}")
}

```

\newpage 

### Question 6 (20 points)

```{r,echo=F}
isflipped = sample(c(T,F),1)
vstrshr = sample(c("stretch","shrink"),1)
mf = sample(c(2,3),1)
if(mf==2 && vstrshr=="stretch"){
    while(T){
        b = sample(c(2,4,6,8),1)
        a = sample(1:8,1)*sample(c(-1,1),1)
        xil = -b/mf-a
        xir = b/mf-a
        if(isflipped){
            dafunk = function(x){-mf*abs(x+a)+b}
            datext = paste0("-",mf,"\\cdot|x+",a,"|+",b)
            datext = gsub("+-","-",datext,fixed=T)
        } else {
            dafunk = function(x){mf*abs(x+a)-b}
            datext = paste0(mf,"\\cdot|x+",a,"|-",b)
            datext = gsub("+-","-",datext,fixed=T)
        }
        if(xil>-10 && xir<10){break}
    }
}
if(mf==3 && vstrshr=="stretch"){
    while(T){
        b = sample(c(3,6,9),1)
        a = sample(1:8,1)*sample(c(-1,1),1)
        xil = -b/mf-a
        xir = b/mf-a
        if(isflipped){
            dafunk = function(x){-mf*abs(x+a)+b}
            datext = paste0("-",mf,"\\cdot|x+",a,"|+",b)
            datext = gsub("+-","-",datext,fixed=T)
        } else {
            dafunk = function(x){mf*abs(x+a)-b}
            datext = paste0(mf,"\\cdot|x+",a,"|-",b)
            datext = gsub("+-","-",datext,fixed=T)
        }
        if(xil>-10 && xir<10){break}
    }
}
if(mf==2 && vstrshr=="shrink"){
    while(T){
        b = sample(1:3,1)
        a = sample(1:7,1)*sample(c(-1,1),1)
        xil = -b*mf-a
        xir = b*mf-a
        if(isflipped){
            dafunk = function(x){-1/mf*abs(x+a)+b}
            datext = paste0("\\frac{-1}{",mf,"}\\cdot|x+",a,"|+",b)
            datext = gsub("+-","-",datext,fixed=T)
        } else {
            dafunk = function(x){1/mf*abs(x+a)-b}
            datext = paste0("\\frac{1}{",mf,"}\\cdot|x+",a,"|-",b)
            datext = gsub("+-","-",datext,fixed=T)
        }
        if(xil>-10 && xir<10){break}
    }
}
if(mf==3 && vstrshr=="shrink"){
    while(T){
        b = sample(1:2,1)
        a = sample(1:6,1)*sample(c(-1,1),1)
        xil = -b*mf-a
        xir = b*mf-a
        if(isflipped){
            dafunk = function(x){-1/mf*abs(x+a)+b}
            datext = paste0("\\frac{-1}{",mf,"}\\cdot|x+",a,"|+",b)
            datext = gsub("+-","-",datext,fixed=T)
        } else {
            dafunk = function(x){1/mf*abs(x+a)-b}
            datext = paste0("\\frac{1}{",mf,"}\\cdot|x+",a,"|-",b)
            datext = gsub("+-","-",datext,fixed=T)
        }
        if(xil>-10 && xir<10){break}
    }
}
if(isflipped){
    pos = paste0("(",xil,",",xir,")")
    neg = paste0("(-\\infty,",xil,")\\cup(",xir,",\\infty)")
    dec = paste0("(",-a,",\\infty)")
    inc = paste0("(-\\infty,",-a,")")
    dom = "(-\\infty,\\infty)"
    ran = paste0("(-\\infty,",b,"]")
} else {
    neg = paste0("(",xil,",",xir,")")
    pos = paste0("(-\\infty,",xil,")\\cup(",xir,",\\infty)")
    inc = paste0("(",-a,",\\infty)")
    dec = paste0("(-\\infty,",-a,")")
    dom = "(-\\infty,\\infty)"
    ran = paste0("[-",b,",\\infty)")
}

if(!(params$showsol)){
    neg = ""
    pos = ""
    dec = ""
    inc = ""
    dom = ""
    ran = ""
} else {
    neg = paste0("\\color{red} $",neg,"$ \\color{black}")
    pos = paste0("\\color{red} $",pos,"$ \\color{black}")
    dec = paste0("\\color{red} $",dec,"$ \\color{black}")
    inc = paste0("\\color{red} $",inc,"$ \\color{black}")
    dom = paste0("\\color{red} $",dom,"$ \\color{black}")
    ran = paste0("\\color{red} $",ran,"$ \\color{black}")
}

```

Make an accurate graph, and describe locations of features.

$$y~=~`r datext`$$

\vfill

```{r,echo=F,fig.dim=c(4,4)}
mkgrid = function(){
    par(mar=c(0,0,0,0),oma=c(0,0,0,0),pty="s")
    lim = 10
    plot(0,0,"n",xlim=c(-lim*1.15,lim*1.15),ylim=c(-lim*1.2,lim*1.2),axes=F,ann=F)
    for(i in -lim:lim){
        lines(c(-lim,lim),c(i,i),col="grey",lwd=0.3)
        lines(c(i,i),c(-lim,lim),col="grey",lwd=0.3)
    }
    for(i in seq(-lim,lim,5)){
        lines(c(-lim,lim),c(i,i),col="darkgrey",lwd=0.8)
        lines(c(i,i),c(-lim,lim),col="darkgrey",lwd=0.8)
    }
    arrows(-lim*1.1,0,lim*1.1,0,0.1,15,3,lwd=1.5)
    arrows(0,-lim*1.1,0,lim*1.1,0.1,15,3,lwd=1.5)
    text(5,-0.5,"5",col="darkgrey",cex=0.6)
    text(10,-0.5,"10",col="darkgrey",cex=0.6)
    text(-5,-0.5,"-5",col="darkgrey",cex=0.6)
    text(-10,-0.5,"-10",col="darkgrey",cex=0.6)
    text(10,0,"x",adj=c(-0.1,-0.4),cex=0.8)
    text(0.5,10,"y",adj=c(0.5,-0.1),cex=0.8)
    for(i in c(-10,-5,5,10)){
        polygon(c(i-0.4,i-0.4,i+0.4,i+0.4),c(-0.1,-0.9,-0.9,-0.1),col="white",border = NA)
        text(i,-0.5,i,col="black",cex=0.6)
        polygon(c(-0.1,-0.95,-0.95,-0.1),c(i-0.4,i-0.4,i+0.4,i+0.4),col="white",border = NA)
        text(-0.5,i,i,col="black",cex=0.6)
    }
}
mkgrid()

if(params$showsol){
    x = seq(-10,10,0.1)
    y = dafunk(x)
    x2 = x[abs(y)<=10]
    y2 = y[abs(y)<=10]
    lines(x2,y2,col="red")
}

```


\begin{tabular}{|m{0.8in}|m{3in}|}\hline
Feature & Where \\ \hline \hline
Domain &  `r dom` \\ [1.7em]  \hline
Range & `r ran` \\ [1.7em]  \hline
Positive & `r pos` \\  [1.7em]  \hline
Negative  & `r neg`  \\ [1.7em]  \hline
Increasing & `r inc` \\ [1.7em]  \hline
Decreasing & `r dec` \\ [1.7em]  \hline
\end{tabular}



