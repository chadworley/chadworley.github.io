mynums = c(mynums,poss[[i]][j],i,dens[[i]][j])
}
XX[[i]] = matrix(mynums,3)
}
print(XX[[1]])
# XC = XX
# for(i in 1:n){
#     plot(0,0,type="n",axes=F,ann=F,xlim=c(-2,2),ylim=c(-2,2))
#     for(j in 1:length(XC[[i]])){
#         Xc = XC[[i]]
#         Xc_flat = P%*%Xc
#         lines(Xc_flat[1,],Xc_flat[2,],col=hsv(i/6,1,0.5))
#         XC[[i]] = R%*%Xc
#     }
# }
getR = function(u,t){
ux = u[1]
uy = u[2]
uz = u[3]
f = cos(t)+ux^2*(1-cos(t))
g = ux*uy*(1-cos(t))-uz*sin(t)
h = ux*uz*(1-cos(t))+uy*sin(t)
i = uy*ux*(1-cos(t))+uz*sin(t)
j = cos(t)+uy^2*(1-cos(t))
k = uy*uz*(1-cos(t))-ux*sin(t)
l = uz*ux*(1-cos(t))-uy*sin(t)
m = uz*uy*(1-cos(t))+ux*sin(t)
n = cos(t)+uz^2*(1-cos(t))
R = matrix(c(f,g,h,i,j,k,l,m,n),3,byrow=T)
return(R)
}
n = 20
R = getR(c(0,0,1),2*pi/n)
P = matrix(c(1,0,0,0,0,1),2,byrow = T)
par(pty="s",mar=c(0,0,0,0))
XX = list()
for(i in 1:6){
mynums = numeric()
for(j in 1:length(poss[[i]])){
mynums = c(mynums,poss[[i]][j],i,dens[[i]][j])
}
XX[[i]] = matrix(mynums,3)
}
print(XX[[2]])
# XC = XX
# for(i in 1:n){
#     plot(0,0,type="n",axes=F,ann=F,xlim=c(-2,2),ylim=c(-2,2))
#     for(j in 1:length(XC[[i]])){
#         Xc = XC[[i]]
#         Xc_flat = P%*%Xc
#         lines(Xc_flat[1,],Xc_flat[2,],col=hsv(i/6,1,0.5))
#         XC[[i]] = R%*%Xc
#     }
# }
getR = function(u,t){
ux = u[1]
uy = u[2]
uz = u[3]
f = cos(t)+ux^2*(1-cos(t))
g = ux*uy*(1-cos(t))-uz*sin(t)
h = ux*uz*(1-cos(t))+uy*sin(t)
i = uy*ux*(1-cos(t))+uz*sin(t)
j = cos(t)+uy^2*(1-cos(t))
k = uy*uz*(1-cos(t))-ux*sin(t)
l = uz*ux*(1-cos(t))-uy*sin(t)
m = uz*uy*(1-cos(t))+ux*sin(t)
n = cos(t)+uz^2*(1-cos(t))
R = matrix(c(f,g,h,i,j,k,l,m,n),3,byrow=T)
return(R)
}
n = 20
R = getR(c(0,0,1),2*pi/n)
P = matrix(c(1,0,0,0,0,1),2,byrow = T)
par(pty="s",mar=c(0,0,0,0))
XX = list()
for(i in 1:6){
mynums = numeric()
for(j in 1:length(poss[[i]])){
mynums = c(mynums,poss[[i]][j],i,dens[[i]][j])
}
XX[[i]] = matrix(mynums,3)
}
XC = XX
for(i in 1:n){
plot(0,0,type="n",axes=F,ann=F,xlim=c(-6,6),ylim=c(-6,6))
for(j in 1:length(XC[[i]])){
Xc = XC[[i]]
Xc_flat = P%*%Xc
lines(Xc_flat[1,],Xc_flat[2,],col=hsv(i/6,1,0.5))
XC[[i]] = R%*%Xc
}
}
getR = function(u,t){
ux = u[1]
uy = u[2]
uz = u[3]
f = cos(t)+ux^2*(1-cos(t))
g = ux*uy*(1-cos(t))-uz*sin(t)
h = ux*uz*(1-cos(t))+uy*sin(t)
i = uy*ux*(1-cos(t))+uz*sin(t)
j = cos(t)+uy^2*(1-cos(t))
k = uy*uz*(1-cos(t))-ux*sin(t)
l = uz*ux*(1-cos(t))-uy*sin(t)
m = uz*uy*(1-cos(t))+ux*sin(t)
n = cos(t)+uz^2*(1-cos(t))
R = matrix(c(f,g,h,i,j,k,l,m,n),3,byrow=T)
return(R)
}
n = 20
R = getR(c(0,0,1),2*pi/n)
P = matrix(c(1,0,0,0,0,1),2,byrow = T)
par(pty="s",mar=c(0,0,0,0))
XX = list()
for(i in 1:6){
mynums = numeric()
for(j in 1:length(poss[[i]])){
mynums = c(mynums,poss[[i]][j],i,dens[[i]][j])
}
XX[[i]] = matrix(mynums,3)
}
XC = XX
for(i in 1:n){
#plot(0,0,type="n",axes=F,ann=F,xlim=c(-6,6),ylim=c(-6,6))
for(j in 1:length(XC[[i]])){
Xc = XC[[i]]
print(Xc)
Xc_flat = P%*%Xc
#lines(Xc_flat[1,],Xc_flat[2,],col=hsv(i/6,1,0.5))
XC[[i]] = R%*%Xc
}
}
getR = function(u,t){
ux = u[1]
uy = u[2]
uz = u[3]
f = cos(t)+ux^2*(1-cos(t))
g = ux*uy*(1-cos(t))-uz*sin(t)
h = ux*uz*(1-cos(t))+uy*sin(t)
i = uy*ux*(1-cos(t))+uz*sin(t)
j = cos(t)+uy^2*(1-cos(t))
k = uy*uz*(1-cos(t))-ux*sin(t)
l = uz*ux*(1-cos(t))-uy*sin(t)
m = uz*uy*(1-cos(t))+ux*sin(t)
n = cos(t)+uz^2*(1-cos(t))
R = matrix(c(f,g,h,i,j,k,l,m,n),3,byrow=T)
return(R)
}
n = 20
R = getR(c(0,0,1),2*pi/n)
P = matrix(c(1,0,0,0,0,1),2,byrow = T)
par(pty="s",mar=c(0,0,0,0))
XX = list()
for(i in 1:6){
mynums = numeric()
for(j in 1:length(poss[[i]])){
mynums = c(mynums,poss[[i]][j]-3.5,i-3.5,dens[[i]][j])
}
XX[[i]] = matrix(mynums,3)
}
XC = XX
for(i in 1:n){
plot(0,0,type="n",axes=F,ann=F,xlim=c(-3,3),ylim=c(0,1))
for(j in 1:6){
Xc = XC[[j]]
print(Xc)
Xc_flat = P%*%Xc
#lines(Xc_flat[1,],Xc_flat[2,],col=hsv(i/6,1,0.5))
XC[[i]] = R%*%Xc
}
}
getR = function(u,t){
ux = u[1]
uy = u[2]
uz = u[3]
f = cos(t)+ux^2*(1-cos(t))
g = ux*uy*(1-cos(t))-uz*sin(t)
h = ux*uz*(1-cos(t))+uy*sin(t)
i = uy*ux*(1-cos(t))+uz*sin(t)
j = cos(t)+uy^2*(1-cos(t))
k = uy*uz*(1-cos(t))-ux*sin(t)
l = uz*ux*(1-cos(t))-uy*sin(t)
m = uz*uy*(1-cos(t))+ux*sin(t)
n = cos(t)+uz^2*(1-cos(t))
R = matrix(c(f,g,h,i,j,k,l,m,n),3,byrow=T)
return(R)
}
n = 20
R = getR(c(0,0,1),2*pi/n)
P = matrix(c(1,0,0,0,0,1),2,byrow = T)
par(pty="s",mar=c(0,0,0,0))
XX = list()
for(i in 1:6){
mynums = numeric()
for(j in 1:length(poss[[i]])){
mynums = c(mynums,poss[[i]][j]-3.5,i-3.5,dens[[i]][j])
}
XX[[i]] = matrix(mynums,3)
}
XC = XX
for(i in 1:n){
plot(0,0,type="n",axes=F,ann=F,xlim=c(-3,3),ylim=c(0,1))
for(j in 1:6){
Xc = XC[[j]]
Xc_flat = P%*%Xc
lines(Xc_flat[1,],Xc_flat[2,],col=hsv(i/6,1,0.5))
XC[[i]] = R%*%Xc
}
}
getR = function(u,t){
ux = u[1]
uy = u[2]
uz = u[3]
f = cos(t)+ux^2*(1-cos(t))
g = ux*uy*(1-cos(t))-uz*sin(t)
h = ux*uz*(1-cos(t))+uy*sin(t)
i = uy*ux*(1-cos(t))+uz*sin(t)
j = cos(t)+uy^2*(1-cos(t))
k = uy*uz*(1-cos(t))-ux*sin(t)
l = uz*ux*(1-cos(t))-uy*sin(t)
m = uz*uy*(1-cos(t))+ux*sin(t)
n = cos(t)+uz^2*(1-cos(t))
R = matrix(c(f,g,h,i,j,k,l,m,n),3,byrow=T)
return(R)
}
n = 20
R = getR(c(0,0,1),2*pi/n)
P = matrix(c(1,0,0,0,0,1),2,byrow = T)
par(pty="s",mar=c(0,0,0,0))
XX = list()
for(i in 1:6){
mynums = numeric()
for(j in 1:length(poss[[i]])){
mynums = c(mynums,poss[[i]][j]-3.5,i-3.5,dens[[i]][j])
}
XX[[i]] = matrix(mynums,3)
}
XC = XX
for(i in 1:n){
plot(0,0,type="n",axes=F,ann=F,xlim=c(-3,3),ylim=c(0,1))
for(j in 1:6){
Xc = XC[[j]]
Xc_flat = P%*%Xc
lines(Xc_flat[1,],Xc_flat[2,],col=hsv(j/6,1,0.5))
XC[[i]] = R%*%Xc
}
}
getR = function(u,t){
ux = u[1]
uy = u[2]
uz = u[3]
f = cos(t)+ux^2*(1-cos(t))
g = ux*uy*(1-cos(t))-uz*sin(t)
h = ux*uz*(1-cos(t))+uy*sin(t)
i = uy*ux*(1-cos(t))+uz*sin(t)
j = cos(t)+uy^2*(1-cos(t))
k = uy*uz*(1-cos(t))-ux*sin(t)
l = uz*ux*(1-cos(t))-uy*sin(t)
m = uz*uy*(1-cos(t))+ux*sin(t)
n = cos(t)+uz^2*(1-cos(t))
R = matrix(c(f,g,h,i,j,k,l,m,n),3,byrow=T)
return(R)
}
n = 20
R = getR(c(0,0,1),2*pi/n)
P = matrix(c(1,0,0,0,0,1),2,byrow = T)
par(pty="s",mar=c(0,0,0,0))
XX = list()
for(i in 1:6){
mynums = numeric()
for(j in 1:length(poss[[i]])){
mynums = c(mynums,poss[[i]][j]-3.5,i-3.5,dens[[i]][j])
}
XX[[i]] = matrix(mynums,3)
}
XC = XX
for(i in 1:n){
plot(0,0,type="n",axes=F,ann=F,xlim=c(-3,3),ylim=c(0,1))
for(j in 1:6){
Xc = XC[[j]]
Xc_flat = P%*%Xc
lines(Xc_flat[1,],Xc_flat[2,],col=hsv(j/6,1,0.5))
XC[[j]] = R%*%Xc
}
}
getR = function(u,t){
ux = u[1]
uy = u[2]
uz = u[3]
f = cos(t)+ux^2*(1-cos(t))
g = ux*uy*(1-cos(t))-uz*sin(t)
h = ux*uz*(1-cos(t))+uy*sin(t)
i = uy*ux*(1-cos(t))+uz*sin(t)
j = cos(t)+uy^2*(1-cos(t))
k = uy*uz*(1-cos(t))-ux*sin(t)
l = uz*ux*(1-cos(t))-uy*sin(t)
m = uz*uy*(1-cos(t))+ux*sin(t)
n = cos(t)+uz^2*(1-cos(t))
R = matrix(c(f,g,h,i,j,k,l,m,n),3,byrow=T)
return(R)
}
n = 40
R = getR(c(0,0,1),2*pi/n)
P = matrix(c(1,0,0,0,0,1),2,byrow = T)
par(pty="s",mar=c(0,0,0,0))
XX = list()
for(i in 1:6){
mynums = numeric()
for(j in 1:length(poss[[i]])){
mynums = c(mynums,poss[[i]][j]-3.5,i-3.5,dens[[i]][j])
}
XX[[i]] = matrix(mynums,3)
}
XC = XX
for(i in 1:n){
plot(0,0,type="n",axes=F,ann=F,xlim=c(-3,3),ylim=c(0,1))
for(j in 1:6){
Xc = XC[[j]]
Xc_flat = P%*%Xc
one = Xc_flat[1,][1]
nn = length(Xc_flat[1,])
las = Xc_flat[1,][nn]
one2 = Xc_flat[2,][1]
nn2 = length(Xc_flat[2,])
las2 = Xc_flat[2,][nn]
polygon(c(one,Xc_flat[1,],las),c(0,Xc_flat[2,],0),col=hsv(j/6,1,0.5))
XC[[j]] = R%*%Xc
}
}
getR = function(u,t){
ux = u[1]
uy = u[2]
uz = u[3]
f = cos(t)+ux^2*(1-cos(t))
g = ux*uy*(1-cos(t))-uz*sin(t)
h = ux*uz*(1-cos(t))+uy*sin(t)
i = uy*ux*(1-cos(t))+uz*sin(t)
j = cos(t)+uy^2*(1-cos(t))
k = uy*uz*(1-cos(t))-ux*sin(t)
l = uz*ux*(1-cos(t))-uy*sin(t)
m = uz*uy*(1-cos(t))+ux*sin(t)
n = cos(t)+uz^2*(1-cos(t))
R = matrix(c(f,g,h,i,j,k,l,m,n),3,byrow=T)
return(R)
}
n = 40
R = getR(c(0,0,1),2*pi/n)
P = matrix(c(1,0,0,0,0,1),2,byrow = T)
par(pty="s",mar=c(0,0,0,0))
XX = list()
for(i in 1:6){
mynums = numeric()
for(j in 1:length(poss[[i]])){
mynums = c(mynums,poss[[i]][j]-3.5,i-3.5,dens[[i]][j])
}
XX[[i]] = matrix(mynums,3)
}
XC = XX
for(i in 1:n){
plot(0,0,type="n",axes=F,ann=F,xlim=c(-3,3),ylim=c(0,1))
for(j in 1:6){
Xc = XC[[j]]
Xc_flat = P%*%Xc
one = Xc_flat[1,][1]
nn = length(Xc_flat[1,])
las = Xc_flat[1,][nn]
one2 = Xc_flat[2,][1]
nn2 = length(Xc_flat[2,])
las2 = Xc_flat[2,][nn]
polygon(c(one,Xc_flat[1,],las),c(0,Xc_flat[2,],0),col=hsv(j/6,1,0.5,0.2),border=hsv(j/6,1,0.5))
XC[[j]] = R%*%Xc
}
}
par(mfrow(1,2),pty="s")
par(mfrow=c(1,2),pty="s")
xs = 0:1
th = seq(0,2*pi,pi/100)
plot(0,0,"n",axes=F,ann=F,xlim=c(-1,1),ylim=c(-1,1))
lines(cos(th),sin(th))
begs = seq(0,2*pi-2*pi/(2),2*pi/(2))
mids = begs+pi/(2)
for(i in begs){
lines(c(0,sin(i)),c(0,cos(i)))
}
for(i in 1:length(xs)){
text(0.8*sin(mids[i]),0.8*cos(mids[i]),xs[i])
}
polygon(0.1*sin(th),0.1*cos(th),col="red")
arrows(-0.6,-0.1,0.6,0.1,length=0.1,angle=25,lwd=7)
arrows(-0.6,-0.1,0.6,0.1,length=0.1,angle=25,lwd=5,col="red")
polygon(0.01*sin(th),0.01*cos(th),col="red")
barplot(rep(1/2,2),1,names.arg=0:1,ylab="probability")
par(mfrow=c(1,2),pty="s")
xs = 0:1
th = seq(0,2*pi,pi/100)
plot(0,0,"n",axes=F,ann=F,xlim=c(-1,1),ylim=c(-1,1))
lines(cos(th),sin(th))
begs = seq(0,2*pi-2*pi/(2),2*pi/(2))
mids = begs+pi/(2)
for(i in begs){
lines(c(0,sin(i)),c(0,cos(i)))
}
for(i in 1:length(xs)){
text(0.8*sin(mids[i]),0.8*cos(mids[i]),xs[i])
}
polygon(0.1*sin(th),0.1*cos(th),col="red")
arrows(-0.6,-0.1,0.6,0.1,length=0.1,angle=25,lwd=7)
arrows(-0.6,-0.1,0.6,0.1,length=0.1,angle=25,lwd=5,col="red")
polygon(0.01*sin(th),0.01*cos(th),col="red")
barplot(rep(1/2,2),1,names.arg=0:1,ylab="density")
par(mfrow=c(1,2),pty="s")
xs = c(0,0.5,0.5,1)
th = seq(0,2*pi,pi/100)
plot(0,0,"n",axes=F,ann=F,xlim=c(-1,1),ylim=c(-1,1))
lines(cos(th),sin(th))
begs = seq(0,2*pi-2*pi/(4),2*pi/(4))
mids = begs+pi/(4)
for(i in begs){
lines(c(0,sin(i)),c(0,cos(i)))
}
for(i in 1:length(xs)){
text(0.8*sin(mids[i]),0.8*cos(mids[i]),xs[i])
}
polygon(0.1*sin(th),0.1*cos(th),col="red")
arrows(-0.6,-0.1,0.6,0.1,length=0.1,angle=25,lwd=7)
arrows(-0.6,-0.1,0.6,0.1,length=0.1,angle=25,lwd=5,col="red")
polygon(0.01*sin(th),0.01*cos(th),col="red")
barplot(c(0.25,0.5,0.25),1,names.arg=0:1,ylab="probability")
par(mfrow=c(1,2),pty="s")
xs = c(0,0.5,0.5,1)
th = seq(0,2*pi,pi/100)
plot(0,0,"n",axes=F,ann=F,xlim=c(-1,1),ylim=c(-1,1))
lines(cos(th),sin(th))
begs = seq(0,2*pi-2*pi/(4),2*pi/(4))
mids = begs+pi/(4)
for(i in begs){
lines(c(0,sin(i)),c(0,cos(i)))
}
for(i in 1:length(xs)){
text(0.8*sin(mids[i]),0.8*cos(mids[i]),xs[i])
}
polygon(0.1*sin(th),0.1*cos(th),col="red")
arrows(-0.6,-0.1,0.6,0.1,length=0.1,angle=25,lwd=7)
arrows(-0.6,-0.1,0.6,0.1,length=0.1,angle=25,lwd=5,col="red")
polygon(0.01*sin(th),0.01*cos(th),col="red")
barplot(c(0.25,0.5,0.25),1,names.arg=c(0,0.5,1),ylab="probability")
par(mfrow=c(1,2),pty="s")
xs = c(0,0.333,0.333,0.333,0.667,0.667,0.667,1)
nnn = length(xs)
th = seq(0,2*pi,pi/100)
plot(0,0,"n",axes=F,ann=F,xlim=c(-1,1),ylim=c(-1,1))
lines(cos(th),sin(th))
begs = seq(0,2*pi-2*pi/(nnn),2*pi/(nnn))
mids = begs+pi/(nnn)
for(i in begs){
lines(c(0,sin(i)),c(0,cos(i)))
}
for(i in 1:length(xs)){
text(0.8*sin(mids[i]),0.8*cos(mids[i]),xs[i])
}
polygon(0.1*sin(th),0.1*cos(th),col="red")
arrows(-0.6,-0.1,0.6,0.1,length=0.1,angle=25,lwd=7)
arrows(-0.6,-0.1,0.6,0.1,length=0.1,angle=25,lwd=5,col="red")
polygon(0.01*sin(th),0.01*cos(th),col="red")
barplot(c(0.125,0.375,0.375,0.125),1,names.arg=c(0,0.333,0.667,1),ylab="probability")
par(mfrow=c(1,2),pty="s")
xs = c(0,rep(0.25,4),rep(0.5,6),rep(0.75,4),1)
nnn = length(xs)
th = seq(0,2*pi,pi/100)
plot(0,0,"n",axes=F,ann=F,xlim=c(-1,1),ylim=c(-1,1))
lines(cos(th),sin(th))
begs = seq(0,2*pi-2*pi/(nnn),2*pi/(nnn))
mids = begs+pi/(nnn)
for(i in begs){
lines(c(0,sin(i)),c(0,cos(i)))
}
for(i in 1:length(xs)){
text(0.8*sin(mids[i]),0.8*cos(mids[i]),xs[i])
}
polygon(0.1*sin(th),0.1*cos(th),col="red")
arrows(-0.6,-0.1,0.6,0.1,length=0.1,angle=25,lwd=7)
arrows(-0.6,-0.1,0.6,0.1,length=0.1,angle=25,lwd=5,col="red")
polygon(0.01*sin(th),0.01*cos(th),col="red")
xcv = sort(unique(xs))
ppp = numeric()
for(vcx in xcv){
ppp=c(ppp,sum(xs==vcx)/length(xs))
}
barplot(ppp,1,names.arg=sort(unique(xs)),ylab="probability")
par(mfrow=c(1,2),pty="s")
xs = c(0,rep(0.25,4),rep(0.5,6),rep(0.75,4),1)
nnn = length(xs)
th = seq(0,2*pi,pi/100)
plot(0,0,"n",axes=F,ann=F,xlim=c(-1,1),ylim=c(-1,1))
lines(cos(th),sin(th))
begs = seq(0,2*pi-2*pi/(nnn),2*pi/(nnn))
mids = begs+pi/(nnn)
for(i in begs){
lines(c(0,sin(i)),c(0,cos(i)))
}
for(i in 1:length(xs)){
text(0.8*sin(mids[i]),0.8*cos(mids[i]),xs[i])
}
polygon(0.1*sin(th),0.1*cos(th),col="red")
arrows(-0.6,-0.1,0.6,0.1,length=0.1,angle=25,lwd=7)
arrows(-0.6,-0.1,0.6,0.1,length=0.1,angle=25,lwd=5,col="red")
polygon(0.01*sin(th),0.01*cos(th),col="red")
xcv = sort(unique(xs))
ppp = numeric()
for(vcx in xcv){
ppp=c(ppp,sum(xs==vcx)/length(xs))
}
barplot(ppp,1,names.arg=sort(unique(xs)),ylab="probability")
